<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<meta name="viewport" content="width=320;" />
		<!--link media="screen" rel="stylesheet" href="css/facebox.css" /-->
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
		<script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
		<script type="text/javascript" src="js/jquery.atmosphere-0.7.js"></script>
		<script type="text/javascript" src="js/jquery.predictem-1.0.js"></script>
		<script type="text/javascript">
			function prependGame(game) {
				// Clone the game template and set the attributes and click handler
				$("#game-template")
					.tmpl({ game: game })
					.prependTo("#games")
					.find("#join").click(function() {
						alert($(this).parent().attr("id")); });
			}
			
			$(document).ready(function() {
				if (location.href.indexOf("#") != -1) {
			        // Get the game id from the supplied hashtag
			    	var id = location.href.substr(location.href.indexOf("#") + 1);
			        
			        // Load the most recently created questions
				
					// Subscribe to the atmosphere game broadcaster
					$.predictem.subscribe("rs/game/" + id + "/subscribe", {
						received: function(game) { prependGame(game); }});
				}
			});
		</script>
		<script id="game-template" type="text/x-jquery-tmpl">
			<div id="{{= game.id}}">
				<span id="name">{{= game.name}}</span>
				<span id="description">{{= game.description}}</span>
				<input id="join" type="button" value="Join">
			</div>
		</script>
	</head>
	<body>
		<div id="game">
			<input id="name" type="text">
			<input id="description" type="text">
			<input id="create" type="button" value="Create">
		</div>
		<div id="games">
		</div>
	</body>
</html>